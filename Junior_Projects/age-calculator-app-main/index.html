<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="./assets/images/favicon-32x32.png"
    />
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,700;1,400;1,800&display=swap"
      rel="stylesheet"
    />
    <title>Frontend Mentor | Age calculator app</title>
    <style>
      .attribution {
        font-size: 11px;
        text-align: center;
      }
      .attribution a {
        color: hsl(228, 45%, 44%);
      }
    </style>
  </head>
  <body>
    <main>
      <form action="" method="post">
        <label for="day">
          <span> Day </span>
          <input
            type="number"
            name="day"
            id="day"
            placeholder="DD"
            maxlength="2"
          />
          <!-- <span class="error_outOfRangeDate">Must be a valid day</span> -->
        </label>
        <label for="month">
          <span> Month </span>
          <input
            type="number"
            name="month"
            id="month"
            placeholder="MM"
            maxlength="2"
          />
        </label>
        <label for="year">
          <span> Year </span>
          <input
            type="number"
            name="year"
            id="year"
            placeholder="YYYY"
            maxlength="4"
          />
        </label>
        <button type="submit" id="submit">
          <img src="./assets/images/icon-arrow.svg" alt="arrow icon" />
        </button>
      </form>

      <div class="calculatedResContainer">
        <div id="calcYear">
          <span class="calculatedNums">--</span>
          <span> years</span>
        </div>
        <div id="calcMonth">
          <span class="calculatedNums">--</span>
          <span> months</span>
        </div>
        <div id="calcDay">
          <span class="calculatedNums">--</span>
          <span> days</span>
        </div>
      </div>
    </main>

    <div class="attribution">
      Challenge by
      <a href="https://www.frontendmentor.io?ref=challenge" target="_blank"
        >Frontend Mentor</a
      >. Coded by <a href="#">Your Name Here</a>.
    </div>

    <span class="error_invalidDate hide">Must be a valid date</span>
    <span class="error_outOfRangeDate hide">Must be a valid ${label}</span>
    <span class="error_required hide">This field is required</span>

    <script>
      let error_invalidDate = document.querySelector(".error_invalidDate");
      let error_outOfRangeDate = document.querySelector(
        ".error_outOfRangeDate"
      );
      let error_required = document.querySelector(".error_required");
      let inputDay = document.getElementById("day");
      let inputMonth = document.getElementById("month");
      let inputYear = document.getElementById("year");
      let submitBtn = document.getElementById("submit");
      let calcDay = document.getElementById("calcDay");
      let calcMonth = document.getElementById("calcMonth");
      let calcYear = document.getElementById("calcYear");
      let form = document.getElementsByName("form");
      submitBtn.addEventListener("click", (e) => {
        e.preventDefault();
        calculateAge(
          Number(inputDay.value),
          Number(inputMonth.value),
          Number(inputYear.value)
        );
        resetErorrClasses();
        emptyInputError();
        outOfDateRangeError();
      });

      function resetErorrClasses() {
        day.classList.remove("error");
        month.classList.remove("error");
        year.classList.remove("error");
        error_invalidDate.classList.add("hide");
        error_outOfRangeDate.classList.add("hide");
        error_required.classList.add("hide");
      }

      function calculateAge(input_day, input_month, input_year) {
        let now = new Date();
        let input_date = new Date(input_year, input_month - 1, input_day);
        let diff = now.getTime() - input_date.getTime();

        calcDay.children[0].textContent = Math.floor(
          diff / (1000 * 60 * 60 * 24)
        );
        calcMonth.children[0].textContent = Math.floor(
          diff / (1000 * 60 * 60 * 24 * 12)
        );
        calcYear.children[0].textContent = Math.floor(
          diff / (1000 * 60 * 60 * 24 * 365.25)
        );
      }

      function emptyInputError() {
        if (inputDay.value == "") {
          error_required.classList.remove("hide");
        }
        if (inputMonth.value == "") {
          error_required.classList.remove("hide");
        }
        if (inputYear.value == "") {
          error_required.classList.remove("hide");
        }
      }

      function outOfDateRangeError() {
        //months out of range erorrs
        if (
          (inputMonth.value == 4 ||
            inputMonth.value == 6 ||
            inputMonth.value == 9 ||
            inputMonth.value == 11) &&
          inputDay.value > 30
        ) {
          console.error("This month can't have more than 30 days");
          day.classList.add("error");
        }
        if (inputMonth.value == 2 && inputDay.value > 28) {
          console.error("February can't have more than 28 days");
          day.classList.add("error");
        }

        //general date errors
        if (inputDay.value > 31 || inputDay.value <= 0) {
          console.error("Must be a valid day");
          day.classList.add("error");
        }
        if (inputMonth.value > 12 || inputMonth.value <= 0) {
          console.error("Must be a valid month");
          month.classList.add("error");
        }
        if (
          inputYear.value > new Date().getFullYear() ||
          inputYear.value == "" ||
          inputYear.value < 0
        ) {
          console.error("Must be a valid year");
          year.classList.add("error");
        }
      }
    </script>
  </body>
</html>
